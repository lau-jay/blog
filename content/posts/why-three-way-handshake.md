---
title: "Why Three Way Handshake"
date: 2021-07-17T00:49:58+08:00
draft: true
---
# 为什么TCP握手要3次
从两个面试题谈起

* ping 100ms, 不考虑网络联通问题，理想情况下http多少，https多少(不考虑非对称加密解密耗时)
* TCP三次握手为啥是3次，2次行不行，TCP握手到底在干嘛？

这两次的关于面试题的对话让人感概颇深, 国内互联网充斥着以讹传讹的博文，却没多少人想着去翻翻RFC。
就连教材往往都是语焉不详。

所以TCP究竟干了什么，从连接开始看

* 顺序问题

* 丢包问题
* 连接维护
* 流量控制
* 拥塞控制

首先：三次握手， 请求-》应答-〉应答应答。

如此就可以回答第一个面试题，ping只是icmp，他的一次来回代表了网络情况，本机到目标机，50ms为单向一次。一个来回两个单向就是100ms。http需要先建立3次握手，加上本身的报文传输，所以最少需要5次250ms。

https更多一次就是6次300ms。

两次行不行，不行：

两次没法构建有来有回，request-response， request -》 response， 中间的sync和ack在header里同时存在可以融合为一次。3次构成了双方互相发送和回复，连接建立后就不需要任何处理了。



[rfc]
